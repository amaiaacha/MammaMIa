{% extends 'base.html' %}

{% block title %}  Donde encontrarnos  {% endblock %}

{% block content %}
<div class="card mb-3">
    {% for direcciones in direccion %}
    <div class="card">
        <div class="card-body">
          <h5 class="card-titlea">{{direcciones.direccion}}</h5>
         <p class="card-text">{{direcciones.numeroTelf}}</p>
        </div>
        <img class="card-img-bottom" src="/media/{{direcciones.image}}" alt="imagen de una tienda fisica">
    </div>
    {% endfor %}
</div>

<div class="contenedorGeo">
        <div id="mapa">
            <span class="mensaje">Encuentra la zona en la que estás para saber mejor que locales te pillan mas cerca!</span>
        </div>  
        <a class="ubicar" href="" title="">Encuentra mi ubicación</a>
            <div id="resultado">
                <span class="longitud"></span><br>
                <span class="latitud"></span><br>
            </div>
</div> 
<script>	
var enlace = jQuery('.ubicar');
var longitud = jQuery('.longitud');
var latitud = jQuery('.latitud');
var mensaje = jQuery('.mensaje');

if (navigator.geolocation) {
} else {
alert('Lo sentimos, tu navegador no soporta geolocation');
}

if (navigator.geolocation) {
enlace.click(function(e) {
  e.preventDefault();
  mensaje.html("Cargando...");
  navigator.geolocation.getCurrentPosition(insUbicacion, ubicacionError);
});
} else {
alert('Tu navegador no soporta geolocation');
}
function insUbicacion(posicion) {
  var glatitud = posicion.coords.latitude;
  var glongitud  = posicion.coords.longitude;
  jQuery('#mapa').html('<iframe width="400" height="300" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="http://maps.google.co.uk/?ie=UTF8&amp;ll='+glatitud+','+glongitud+'&amp;spn=0.332359,0.617294&amp;t=m&amp;z=11&amp;output=embed"></iframe>');
  longitud.html('Longitud: '+glongitud);
  latitud.html('Latitud: '+glatitud);
 
  jQuery.ajax({
      url: 'http://maps.googleapis.com/maps/api/geocode/json?latlng='+glatitud+','+glongitud+'&sensor=true',
      type: 'POST',
      dataType: 'json',
      error: function(xhr, textStatus, errorThrown) {
          ubicacionError();
       }
   });
         
}
function ubicacionError() {
   alert('No se ha podido encontrar tu ubicación exacta');
}</script>

{% endblock %}